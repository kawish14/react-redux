{"version":3,"file":"cedar.js","sources":["../../../../node_modules/deepmerge/dist/es.js","../../../cedar-amcharts/dist/esm/specs/specs.js","../../../cedar-amcharts/dist/esm/specs/bar.js","../../../cedar-amcharts/dist/esm/specs/bar-horizontal.js","../../../cedar-amcharts/dist/esm/specs/line.js","../../../cedar-amcharts/dist/esm/specs/area.js","../../../cedar-amcharts/dist/esm/specs/pie.js","../../../cedar-amcharts/dist/esm/specs/radar.js","../../../cedar-amcharts/dist/esm/specs/scatter.js","../../../cedar-amcharts/dist/esm/specs/timeline.js","../../../cedar-amcharts/dist/esm/render/render.js","../esm/dataset.js","../../../../node_modules/tslib/tslib.es6.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/process-params.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-query-string.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/ArcGISRequestError.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/ArcGISAuthError.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/request.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/ErrorTypes.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-form-data.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/check-for-errors.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/clean-url.js","../../../../node_modules/@esri/arcgis-rest-feature-layer/dist/esm/query.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/append-custom-params.js","../../../../node_modules/@esri/arcgis-rest-feature-layer/dist/esm/decodeValues.js","../../../../node_modules/@esri/arcgis-rest-feature-layer/dist/esm/getLayer.js","../esm/config.js","../esm/query/query.js","../esm/query/url.js","../esm/Chart.js","../../../cedar-amcharts/dist/esm/index.js"],"sourcesContent":["var isMergeableObject = function isMergeableObject(value) {\n\treturn isNonNullObject(value)\n\t\t&& !isSpecial(value)\n};\n\nfunction isNonNullObject(value) {\n\treturn !!value && typeof value === 'object'\n}\n\nfunction isSpecial(value) {\n\tvar stringValue = Object.prototype.toString.call(value);\n\n\treturn stringValue === '[object RegExp]'\n\t\t|| stringValue === '[object Date]'\n\t\t|| isReactElement(value)\n}\n\n// see https://github.com/facebook/react/blob/b5ac963fb791d1298e7f396236383bc955f916c1/src/isomorphic/classic/element/ReactElement.js#L21-L25\nvar canUseSymbol = typeof Symbol === 'function' && Symbol.for;\nvar REACT_ELEMENT_TYPE = canUseSymbol ? Symbol.for('react.element') : 0xeac7;\n\nfunction isReactElement(value) {\n\treturn value.$$typeof === REACT_ELEMENT_TYPE\n}\n\nfunction emptyTarget(val) {\n    return Array.isArray(val) ? [] : {}\n}\n\nfunction cloneIfNecessary(value, optionsArgument) {\n    var clone = optionsArgument && optionsArgument.clone === true;\n    return (clone && isMergeableObject(value)) ? deepmerge(emptyTarget(value), value, optionsArgument) : value\n}\n\nfunction defaultArrayMerge(target, source, optionsArgument) {\n    var destination = target.slice();\n    source.forEach(function(e, i) {\n        if (typeof destination[i] === 'undefined') {\n            destination[i] = cloneIfNecessary(e, optionsArgument);\n        } else if (isMergeableObject(e)) {\n            destination[i] = deepmerge(target[i], e, optionsArgument);\n        } else if (target.indexOf(e) === -1) {\n            destination.push(cloneIfNecessary(e, optionsArgument));\n        }\n    });\n    return destination\n}\n\nfunction mergeObject(target, source, optionsArgument) {\n    var destination = {};\n    if (isMergeableObject(target)) {\n        Object.keys(target).forEach(function(key) {\n            destination[key] = cloneIfNecessary(target[key], optionsArgument);\n        });\n    }\n    Object.keys(source).forEach(function(key) {\n        if (!isMergeableObject(source[key]) || !target[key]) {\n            destination[key] = cloneIfNecessary(source[key], optionsArgument);\n        } else {\n            destination[key] = deepmerge(target[key], source[key], optionsArgument);\n        }\n    });\n    return destination\n}\n\nfunction deepmerge(target, source, optionsArgument) {\n    var sourceIsArray = Array.isArray(source);\n    var targetIsArray = Array.isArray(target);\n    var options = optionsArgument || { arrayMerge: defaultArrayMerge };\n    var sourceAndTargetTypesMatch = sourceIsArray === targetIsArray;\n\n    if (!sourceAndTargetTypesMatch) {\n        return cloneIfNecessary(source, optionsArgument)\n    } else if (sourceIsArray) {\n        var arrayMerge = options.arrayMerge || defaultArrayMerge;\n        return arrayMerge(target, source, optionsArgument)\n    } else {\n        return mergeObject(target, source, optionsArgument)\n    }\n}\n\ndeepmerge.all = function deepmergeAll(array, optionsArgument) {\n    if (!Array.isArray(array) || array.length < 2) {\n        throw new Error('first argument should be an array with at least two elements')\n    }\n\n    // we are sure there are at least 2 values, so it is safe to have no initial value\n    return array.reduce(function(prev, next) {\n        return deepmerge(prev, next, optionsArgument)\n    })\n};\n\nvar deepmerge_1 = deepmerge;\n\nexport default deepmerge_1;\n","import area from './area';\nimport bar from './bar';\nimport barHorizontal from './bar-horizontal';\nimport line from './line';\nimport pie from './pie';\nimport radar from './radar';\nimport scatter from './scatter';\nimport timeline from './timeline';\nvar specs = {\n    bar: bar,\n    'bar-horizontal': barHorizontal,\n    line: line,\n    area: area,\n    pie: pie,\n    radar: radar,\n    scatter: scatter,\n    timeline: timeline\n};\nexport default specs;\n//# sourceMappingURL=specs.js.map","export var bar = {\n    type: 'serial',\n    rotate: false,\n    theme: 'calcite',\n    chartCursor: {\n        categoryBalloonEnabled: false\n    },\n    graphs: [{\n            type: 'column',\n            newStack: true\n        }],\n    legend: {\n        valueAlign: 'left',\n        spacing: 25\n    },\n    valueAxes: [{\n            stackType: 'regular'\n        }],\n    export: {\n        enabled: true\n    }\n};\nexport default bar;\n//# sourceMappingURL=bar.js.map","export var barHorizontal = {\n    type: 'serial',\n    theme: 'calcite',\n    rotate: true,\n    chartCursor: {\n        leaveCursor: true,\n        valueLineEnabled: true,\n        categoryBalloonEnabled: false\n    },\n    graphs: [{\n            type: 'column',\n        }],\n    legend: {},\n    valueAxes: [{\n            gridAlpha: 0.2,\n            stackType: 'regular'\n        }],\n    export: {\n        enabled: true\n    }\n};\nexport default barHorizontal;\n//# sourceMappingURL=bar-horizontal.js.map","var line = {\n    type: 'serial',\n    theme: 'calcite',\n    chartCursor: {\n        categoryBalloonEnabled: false,\n        valueLineBalloonEnabled: true\n    },\n    graphs: [{\n            bullet: 'circle',\n            bulletAlpha: 1,\n            bulletBorderAlpha: 0.8,\n            bulletBorderThickness: 0,\n            // bulletColor: '#FFFFFF',\n            dashLengthField: 'dashLengthLine',\n            fillAlphas: 0,\n            useLineColorForBulletBorder: true\n        }],\n    legend: {\n        // horizontalGap: 10,\n        position: 'bottom',\n        useGraphSettings: true\n    },\n    export: {\n        enabled: true\n    }\n};\nexport default line;\n//# sourceMappingURL=line.js.map","var area = {\n    type: 'serial',\n    theme: 'calcite',\n    chartCursor: {\n        categoryBalloonEnabled: false,\n        valueLineBalloonEnabled: true\n    },\n    graphs: [{\n            bullet: 'circle',\n            bulletAlpha: 1,\n            bulletBorderAlpha: 0.8,\n            bulletBorderThickness: 0,\n            dashLengthField: 'dashLengthLine',\n            fillAlphas: 0.5,\n            useLineColorForBulletBorder: true\n        }],\n    legend: {\n        horizontalGap: 10,\n        position: 'bottom',\n        useGraphSettings: true,\n        markerSize: 10\n    },\n    valueAxes: [{\n            stackType: 'regular'\n        }],\n    export: {\n        enabled: true\n    }\n};\nexport default area;\n//# sourceMappingURL=area.js.map","var pie = {\n    type: 'pie',\n    theme: 'calcite',\n    innerRadius: '0%',\n    startDuration: 0,\n    graphs: [{}],\n    groupPercent: 5,\n    balloon: {\n        fixedPosition: true\n    },\n    legend: {\n        enabled: false\n    },\n    export: {\n        enabled: true\n    }\n};\nexport default pie;\n//# sourceMappingURL=pie.js.map","var radar = {\n    type: 'radar',\n    valueAxes: [{\n            gridType: 'circles',\n            minimum: 0\n        }],\n    polarScatter: {\n        minimum: 0,\n        maximum: 400,\n        step: 1\n    },\n    startDuration: 0,\n    graphs: [{ graphFillAlpha: 0 }],\n    groupPercent: 5,\n    balloon: {\n        fixedPosition: true\n    },\n    legend: {\n        position: 'right',\n        marginRight: 100,\n        autoMargins: false\n    },\n};\nexport default radar;\n//# sourceMappingURL=radar.js.map","var scatter = {\n    type: 'xy',\n    theme: 'calcite',\n    valueAxes: [{\n            axisAlpha: 0.8,\n            gridAlpha: 0.2,\n            position: 'bottom',\n        }, {\n            axisAlpha: 0.8,\n            gridAlpha: 0.2,\n            position: 'left'\n        }],\n    chartScrollbar: {\n        scrollbarHeight: 5,\n        offset: -1,\n        backgroundAlpha: 0.1,\n        backgroundColor: '#888888',\n        selectedBackgroundColor: '#67b7dc',\n        selectedBackgroundAlpha: 1,\n        dragIconWidth: 15,\n        dragIconHeight: 15,\n    },\n    chartCursor: {\n        categoryBalloonEnabled: true,\n        cursorAlpha: 0.3,\n        valueLineAlpha: 0.3,\n        valueLineBalloonEnabled: true\n    },\n    graphs: [{\n            fillAlphas: 0,\n            lineAlpha: 0,\n            bullet: 'circle',\n            bulletBorderAlpha: 0.2,\n            bulletAlpha: 0.8,\n            valueField: null,\n            xField: null,\n            yField: null,\n        }],\n    export: {\n        enabled: true\n    }\n};\nexport default scatter;\n//# sourceMappingURL=scatter.js.map","var timeline = {\n    type: 'serial',\n    theme: 'calcite',\n    chartCursor: {\n        categoryBalloonEnabled: false,\n        valueLineBalloonEnabled: true\n    },\n    graphs: [{\n            bullet: 'circle',\n            bulletAlpha: 1,\n            bulletBorderAlpha: 0.8,\n            bulletBorderThickness: 0,\n            // bulletColor: '#FFFFFF',\n            dashLengthField: 'dashLengthLine',\n            fillAlphas: 0,\n            useLineColorForBulletBorder: true\n        }],\n    legend: {\n        // horizontalGap: 10,\n        position: 'bottom',\n        useGraphSettings: true\n    },\n    categoryAxis: {\n        parseDates: true\n    },\n    export: {\n        enabled: true\n    }\n};\nexport default timeline;\n//# sourceMappingURL=timeline.js.map","import merge from 'deepmerge';\nimport specs from '../specs/specs';\n// TODO: how to have access to IDefinition\nexport function renderChart(elementId, definition, data) {\n    if (definition.type === 'custom') {\n        var chart_1 = AmCharts.makeChart(elementId, definition.specification);\n        return chart_1;\n    }\n    // Clone/copy spec and data\n    // Longer than normal conditional so setting as its own const\n    var hasSpecAndIsntString = definition.specification && typeof definition.specification !== 'string';\n    // ternary checking to see if there is a def.spec and that it is NOT a string (url)\n    // if true than return def.spec. If not true than fetch a premade spec\n    var spec = hasSpecAndIsntString ? clone(definition.specification) : fetchSpec(definition.type);\n    var copyData = clone(data);\n    // Set the spec's data\n    spec.dataProvider = copyData;\n    // Apply the series\n    if (!!definition.datasets) {\n        spec = fillInSpec(spec, definition);\n    }\n    // Apply overrides\n    if (definition.overrides) {\n        // NOTE: this counts on using deepmerge < 2.x\n        // see: https://github.com/KyleAMathews/deepmerge#arraymerge\n        spec = merge(spec, definition.overrides, { clone: true });\n    }\n    var chart = AmCharts.makeChart(elementId, spec);\n    // If it is a pie chart\n    if (definition.type === 'pie') {\n        // Set pie chart balloonText\n        chart.balloonText = getPieBalloonText(definition);\n    }\n    return chart;\n}\nfunction getPieBalloonText(definition) {\n    // Set label based on whether or not there actually is a category label\n    var categoryLabel = !!definition.series[0].category.label ? definition.series[0].category.label + \": \" : '';\n    // Set label based on whether or not there actually is a value label\n    var valueLabel = !!definition.series[0].value.label ? definition.series[0].value.label + \": \" : '';\n    // return balloonText\n    return \"<div>\" + categoryLabel + \"[[title]]</div><div>\" + valueLabel + \"[[percents]]% ([[value]])</div>\";\n}\nexport function fillInSpec(spec, definition) {\n    // Grab the graphSpec from the spec\n    var graphSpec = spec.graphs.pop();\n    var isJoined = definition.datasets.length > 1;\n    // category field will be 'categoryField' in the case of joined datasets\n    // otherwise get it from the first series\n    spec.categoryField = isJoined ? 'categoryField' : definition.series[0].category.field;\n    // Set tabIndex for the chart\n    spec.tabIndex = 0;\n    // Add a legend in case it's not on the spec\n    if (!spec.legend) {\n        spec.legend = {};\n    }\n    // TODO This is needed as 'legend.enable' has been renamed 'legend.visible'. We are only introducing\n    // breaking changes on major releases.\n    // Remove the line below on next breaking change\n    /* istanbul ignore next since we're going to remove this */\n    if (definition.legend && definition.legend.hasOwnProperty('enable')) {\n        definition.legend.visible = definition.legend.enable;\n    }\n    // adjust legend and axis labels for single series charts\n    if (definition.series.length === 1 && (definition.type !== 'pie' && definition.type !== 'radar')) {\n        // don't show legend by default for single series charts\n        spec.legend.enabled = false;\n        // get default axis labels from series\n        var categoryAxisTitle_1 = definition.series[0].category.label;\n        var valueAxisTitle_1 = definition.series[0].value.label;\n        if (spec.type === 'xy' && Array.isArray(spec.valueAxes)) {\n            // for xy charts we treat the x axis as the category axis\n            // and the y axis as the value axis\n            spec.valueAxes.forEach(function (axis) {\n                /* istanbul ignore else since we can only be smart about bottom/left axis labels */\n                if (axis.position === 'bottom') {\n                    axis.title = categoryAxisTitle_1;\n                }\n                else if (axis.position === 'left') {\n                    axis.title = valueAxisTitle_1;\n                }\n            });\n        }\n        else {\n            // line/area specs don't define axes\n            if (!spec.valueAxes) {\n                spec.valueAxes = [{}];\n            }\n            spec.valueAxes[0].title = definition.series[0].value.label;\n            spec.valueAxes[0].position = 'left';\n            /* istanbul ignore else until we have a test for a timeline definition/spec */\n            if (!spec.categoryAxis) {\n                spec.categoryAxis = {};\n            }\n            spec.categoryAxis.title = categoryAxisTitle_1;\n        }\n    }\n    // Handle Legend in case.\n    if (definition.legend) {\n        var legend = definition.legend;\n        var supportedLegendPositions = ['top', 'bottom', 'left', 'right'];\n        if (legend.hasOwnProperty('visible')) {\n            spec.legend.enabled = legend.visible;\n            // If there is a legend on the page add a tabIndex\n            spec.legend.tabIndex = 0;\n        }\n        if (legend.position && supportedLegendPositions.indexOf(legend.position) > -1) {\n            spec.legend.position = legend.position;\n        }\n    }\n    // Handle styles...\n    /* istanbul ignore if */\n    if (definition.style) {\n        // snag out style\n        var style = definition.style;\n        // handle margins\n        /* istanbul ignore if */\n        if (style.padding) {\n            var padding = style.padding;\n            // Assume we need to set auto margins false\n            spec.autoMargins = false;\n            if (padding.hasOwnProperty('top')) {\n                spec.marginTop = padding.top;\n            }\n            if (padding.hasOwnProperty('bottom')) {\n                spec.marginBottom = padding.bottom;\n            }\n            if (padding.hasOwnProperty('left')) {\n                spec.marginLeft = padding.left;\n            }\n            if (padding.hasOwnProperty('right')) {\n                spec.marginRight = padding.right;\n            }\n        }\n        // If there is a pie property\n        /* istanbul ignore if */\n        if (style.pie) {\n            var pie = style.pie;\n            // A range from 0 - n where n is the inner radius of the pie chart. Anything above a 0\n            // turns the chart into a donut chart. Can be a number for pixels or a percent.\n            if (pie.hasOwnProperty('innerRadius')) {\n                spec.innerRadius = pie.innerRadius;\n            }\n            // How far a pie chart slice will pull out when selected. Can be a number for pixels or a percent\n            if (pie.hasOwnProperty('expand')) {\n                spec.pullOutRadius = pie.expand;\n            }\n        }\n        if (style.colors && Array.isArray(style.colors)) {\n            spec.colors = style.colors;\n        }\n    }\n    // Iterate over datasets\n    definition.datasets.forEach(function (dataset, d) {\n        var datasetName = dataset.name;\n        // For each dataset iterate over series\n        definition.series.forEach(function (series, s) {\n            if (dataset.name === series.source) {\n                var graph = clone(graphSpec);\n                // use the value field label for the graph's title\n                graph.title = series.value.label;\n                // value field will contain dataset name if joined\n                graph.valueField = isJoined ? datasetName + \"_\" + series.value.field : series.value.field;\n                // TODO: map other fields besides value like color, size, etc\n                // tooltip\n                graph.balloonText = \"<div>\" + series.category.label + \": [[\" + spec.categoryField + \"]]</div><div>\" + graph.title + \": [[\" + graph.valueField + \"]]</div>\";\n                // Group vs. stack\n                if (!!series.stack && graph.newStack) {\n                    graph.newStack = false;\n                }\n                // special props for pie charts\n                if (definition.type === 'pie') {\n                    spec.titleField = spec.categoryField;\n                    spec.valueField = graph.valueField;\n                }\n                // special props for x/y types (scatter, bubble)\n                if (spec.type === 'xy' && !!series.category && !!series.value) {\n                    graph.xField = series.category.field;\n                    graph.yField = series.value.field;\n                    graph.balloonText = \"<div>\" + series.category.label + \": [[\" + series.category.field + \"]]</div><div>\" + series.value.label + \": [[\" + series.value.field + \"]]</div>\";\n                    // bubble\n                    if (spec.type === 'xy' && series.size) {\n                        graph.valueField = series.size.field;\n                        graph.balloonText = graph.balloonText + \"<div>\" + series.size.label + \": [[\" + graph.valueField + \"]]</div>\";\n                    }\n                    else {\n                        delete graph.valueField;\n                    }\n                }\n                spec.graphs.push(graph);\n            }\n        });\n    });\n    return spec;\n}\nexport function fetchSpec(type) {\n    var spec = type;\n    if (spec === 'time') {\n        console.warn(\"'time' is no longer a supported type. Please use 'timeline' instead\");\n        spec = 'timeline';\n    }\n    else if (spec === 'bubble') {\n        console.warn(\"'bubble' is no longer a supported type. Please use 'scatter' instead\");\n        spec = 'scatter';\n    }\n    else if (spec === 'grouped') {\n        console.warn(\"'grouped' is no longer a supported type. Please use 'bar' instead\");\n        spec = 'bar';\n    }\n    return clone(specs[spec]);\n}\nfunction clone(json) {\n    return JSON.parse(JSON.stringify(json));\n}\n// TODO: remove\nvar render = {\n    renderChart: renderChart,\n    fillInSpec: fillInSpec,\n    fetchSpec: fetchSpec\n};\nexport default render;\n//# sourceMappingURL=render.js.map","// if it's a feature set, return the array of features\n// otherwise just return the array of objects that was passed in\nfunction getFeatures(data) {\n    return data.features ? data.features : data;\n}\n// if it's a feature, return the attributes\n// otherwise return the entire object that was passed in\nfunction getAttributes(row) {\n    /* istanbul ignore else since that only happens when features are mixed with rows */\n    if (row.attributes) {\n        return row.attributes;\n    }\n    else {\n        return row;\n    }\n}\n// get an array of value field names from a dataset's series\nfunction getDatasetValueFields(datasetName, series) {\n    return series.reduce(function (fields, s) {\n        if (s.source === datasetName && s.value) {\n            fields.push(s.value.field);\n        }\n        return fields;\n    }, []);\n}\n// get a unique field (property) name for a dataset/value field\nfunction getDatasetValueFieldName(datasetName, valueField) {\n    return datasetName + \"_\" + valueField;\n}\nfunction getDatasetData(dataset, datasetsData, name) {\n    var datasetName = dataset.name || name;\n    return dataset.data || datasetsData[datasetName];\n}\n// if data is a feature set or array of features\n// return only the attributes for each feature\nfunction flattenData(data) {\n    var features = getFeatures(data);\n    if (features.length > 0 && features[0].attributes) {\n        // these really are features, flatten them before\n        return features.map(getAttributes);\n    }\n    else {\n        // assume this is an array of objects and don't\n        return features;\n    }\n}\n// join data from multiple datasets into a single table\nfunction joinData(datasets, series, datasetsData) {\n    // first build a hash whose keys for each of the\n    // unique values in the join columns of the datasets\n    // and the value of each is a row with the joined values\n    var hashTable = datasets.reduce(function (index, dataset, i) {\n        // get the attribute that this dataset will be joined on\n        var joinKey = dataset.join;\n        // TODO: what if no joinKey, throw error? skip this dataset?\n        // if dataset doesn't have inline data use data that was passed in\n        var datasetData = getDatasetData(dataset, datasetsData);\n        // TODO: what if no datasetData, throw error? skip this dataset?\n        // get the value fields for this dataset from it's series\n        var datasetName = dataset.name;\n        var valueFields = getDatasetValueFields(datasetName, series);\n        // TODO: what if no valueFields, throw error? skip this dataset?\n        getFeatures(datasetData).forEach(function (feature) {\n            // get the value of the column that this dataset should be joined on\n            var attrs = getAttributes(feature);\n            var joinValue = attrs[joinKey];\n            // start a new row for this value if there isn't one already\n            if (index[joinValue] === undefined) {\n                // use this value for the categoryField\n                index[joinValue] = { categoryField: joinValue };\n            }\n            // get the remaining values for this row\n            valueFields.reduce(function (row, valueField) {\n                // add a property to the row for this dataset and value field\n                row[getDatasetValueFieldName(datasetName, valueField)] = attrs[valueField];\n                // valueFields.splice(i, 1)\n                return row;\n            }, index[joinValue]);\n        });\n        return index;\n    }, {});\n    // return the rows of joined values from the hash table\n    return Object.keys(hashTable).map(function (key) { return hashTable[key]; });\n}\n// flatten data from all datasets into a single table\nexport function getChartData(datasets, options) {\n    if (!datasets) {\n        return;\n    }\n    if (datasets.length < 1) {\n        return [];\n    }\n    var datasetsData = options && options.datasetsData;\n    if (datasets.length > 1) {\n        // TODO: what if no series? throw error?\n        var series = options && options.series;\n        // TODO: support other ways of merging (append, etc), but for now just\n        // join the feature sets into a single table\n        return joinData(datasets, series, datasetsData);\n    }\n    // just flatten the feature set into a table\n    // TODO: make name required on datasets, or required if > 1 dataset?\n    var datasetData = getDatasetData(datasets[0], datasetsData, 'dataset0');\n    return flattenData(datasetData);\n}\n//# sourceMappingURL=dataset.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Checks parameters to see if we should use FormData to send the request\n * @param params The object whose keys will be encoded.\n * @return A boolean indicating if FormData will be required.\n */\nexport function requiresFormData(params) {\n    return Object.keys(params).some(function (key) {\n        var value = params[key];\n        if (!value) {\n            return false;\n        }\n        if (value && value.toParam) {\n            value = value.toParam();\n        }\n        var type = value.constructor.name;\n        switch (type) {\n            case \"Array\":\n                return false;\n            case \"Object\":\n                return false;\n            case \"Date\":\n                return false;\n            case \"Function\":\n                return false;\n            case \"Boolean\":\n                return false;\n            case \"String\":\n                return false;\n            case \"Number\":\n                return false;\n            default:\n                return true;\n        }\n    });\n}\n/**\n * Converts parameters to the proper representation to send to the ArcGIS REST API.\n * @param params The object whose keys will be encoded.\n * @return A new object with properly encoded values.\n */\nexport function processParams(params) {\n    var newParams = {};\n    Object.keys(params).forEach(function (key) {\n        var param = params[key];\n        if (param && param.toParam) {\n            param = param.toParam();\n        }\n        if (!param &&\n            param !== 0 &&\n            typeof param !== \"boolean\" &&\n            typeof param !== \"string\") {\n            return;\n        }\n        var type = param.constructor.name;\n        var value;\n        // properly encodes objects, arrays and dates for arcgis.com and other services.\n        // ported from https://github.com/Esri/esri-leaflet/blob/master/src/Request.js#L22-L30\n        // also see https://github.com/Esri/arcgis-rest-js/issues/18:\n        // null, undefined, function are excluded. If you want to send an empty key you need to send an empty string \"\".\n        switch (type) {\n            case \"Array\":\n                // Based on the first element of the array, classify array as an array of objects to be stringified\n                // or an array of non-objects to be comma-separated\n                value =\n                    param[0] &&\n                        param[0].constructor &&\n                        param[0].constructor.name === \"Object\"\n                        ? JSON.stringify(param)\n                        : param.join(\",\");\n                break;\n            case \"Object\":\n                value = JSON.stringify(param);\n                break;\n            case \"Date\":\n                value = param.valueOf();\n                break;\n            case \"Function\":\n                value = null;\n                break;\n            case \"Boolean\":\n                value = param + \"\";\n                break;\n            default:\n                value = param;\n                break;\n        }\n        if (value || value === 0 || typeof value === \"string\") {\n            newParams[key] = value;\n        }\n    });\n    return newParams;\n}\n//# sourceMappingURL=process-params.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams } from \"./process-params\";\nexport function encodeParam(key, value) {\n    return encodeURIComponent(key) + \"=\" + encodeURIComponent(value);\n}\n/**\n * Encodes the passed object as a query string.\n *\n * @param params An object to be encoded.\n * @returns An encoded query string.\n */\nexport function encodeQueryString(params) {\n    var newParams = processParams(params);\n    return Object.keys(newParams)\n        .map(function (key) {\n        return encodeParam(key, newParams[key]);\n    })\n        .join(\"&\");\n}\n//# sourceMappingURL=encode-query-string.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n// TypeScript 2.1 no longer allows you to extend built in types. See https://github.com/Microsoft/TypeScript/issues/12790#issuecomment-265981442\n// and https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n//\n// This code is from MDN https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types.\nvar ArcGISRequestError = /** @class */ (function () {\n    /**\n     * Create a new `ArcGISRequestError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options and parameters of the request\n     */\n    function ArcGISRequestError(message, code, response, url, options) {\n        message = message || \"UNKNOWN_ERROR\";\n        code = code || \"UNKNOWN_ERROR_CODE\";\n        this.name = \"ArcGISRequestError\";\n        this.message =\n            code === \"UNKNOWN_ERROR_CODE\" ? message : code + \": \" + message;\n        this.originalMessage = message;\n        this.code = code;\n        this.response = response;\n        this.url = url;\n        this.options = options;\n    }\n    return ArcGISRequestError;\n}());\nexport { ArcGISRequestError };\nArcGISRequestError.prototype = Object.create(Error.prototype);\nArcGISRequestError.prototype.constructor = ArcGISRequestError;\n//# sourceMappingURL=ArcGISRequestError.js.map","import * as tslib_1 from \"tslib\";\nimport { ArcGISRequestError } from \"./ArcGISRequestError\";\nimport { request } from \"../request\";\nvar ArcGISAuthError = /** @class */ (function (_super) {\n    tslib_1.__extends(ArcGISAuthError, _super);\n    /**\n     * Create a new `ArcGISAuthError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options of the request\n     */\n    function ArcGISAuthError(message, code, response, url, options) {\n        if (message === void 0) { message = \"AUTHENTICATION_ERROR\"; }\n        if (code === void 0) { code = \"AUTHENTICATION_ERROR_CODE\"; }\n        var _this = _super.call(this, message, code, response, url, options) || this;\n        _this.name = \"ArcGISAuthError\";\n        _this.message =\n            code === \"AUTHENTICATION_ERROR_CODE\" ? message : code + \": \" + message;\n        return _this;\n    }\n    ArcGISAuthError.prototype.retry = function (getSession, retryLimit) {\n        var _this = this;\n        if (retryLimit === void 0) { retryLimit = 3; }\n        var tries = 0;\n        var retryRequest = function (resolve, reject) {\n            getSession(_this.url, _this.options)\n                .then(function (session) {\n                var newOptions = tslib_1.__assign({}, _this.options, { authentication: session });\n                tries = tries + 1;\n                return request(_this.url, newOptions);\n            })\n                .then(function (response) {\n                resolve(response);\n            })\n                .catch(function (e) {\n                if (e.name === \"ArcGISAuthError\" && tries < retryLimit) {\n                    retryRequest(resolve, reject);\n                }\n                else if (e.name === \"ArcGISAuthError\" && tries >= retryLimit) {\n                    reject(_this);\n                }\n                else {\n                    reject(e);\n                }\n            });\n        };\n        return new Promise(function (resolve, reject) {\n            retryRequest(resolve, reject);\n        });\n    };\n    return ArcGISAuthError;\n}(ArcGISRequestError));\nexport { ArcGISAuthError };\n//# sourceMappingURL=ArcGISAuthError.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport * as tslib_1 from \"tslib\";\nimport { encodeFormData } from \"./utils/encode-form-data\";\nimport { encodeQueryString } from \"./utils/encode-query-string\";\nimport { requiresFormData } from \"./utils/process-params\";\nimport { checkForErrors } from \"./utils/check-for-errors\";\nimport { ArcGISRequestError } from \"./utils/ArcGISRequestError\";\nimport { warn } from \"./utils/warn\";\nexport var NODEJS_DEFAULT_REFERER_HEADER = \"@esri/arcgis-rest-js\";\nvar DEFAULT_ARCGIS_REQUEST_OPTIONS = {\n    httpMethod: \"POST\",\n    params: {\n        f: \"json\"\n    }\n};\n/**\n * Sets the default options that will be passed in **all requests across all `@esri/arcgis-rest-js` modules**.\n *\n *\n * ```js\n * import { setDefaultRequestOptions } from \"@esri/arcgis-rest-request\";\n * setDefaultRequestOptions({\n *   authentication: userSession // all requests will use this session by default\n * })\n * ```\n * You should **never** set a default `authentication` when you are in a server side environment where you may be handling requests for many different authenticated users.\n *\n * @param options The default options to pass with every request. Existing default will be overwritten.\n * @param hideWarnings Silence warnings about setting default `authentication` in shared environments.\n */\nexport function setDefaultRequestOptions(options, hideWarnings) {\n    if (options.authentication && !hideWarnings) {\n        warn(\"You should not set `authentication` as a default in a shared environment such as a web server which will process multiple users requests. You can call `setDefaultRequestOptions` with `true` as a second argument to disable this warning.\");\n    }\n    DEFAULT_ARCGIS_REQUEST_OPTIONS = options;\n}\n/**\n * ```js\n * import { request } from '@esri/arcgis-rest-request';\n * //\n * request('https://www.arcgis.com/sharing/rest')\n *   .then(response) // response.currentVersion === 5.2\n * //\n * request('https://www.arcgis.com/sharing/rest', {\n *   httpMethod: \"GET\"\n * })\n * //\n * request('https://www.arcgis.com/sharing/rest/search', {\n *   params: { q: 'parks' }\n * })\n *   .then(response) // response.total => 78379\n * ```\n * Generic method for making HTTP requests to ArcGIS REST API endpoints.\n *\n * @param url - The URL of the ArcGIS REST API endpoint.\n * @param requestOptions - Options for the request, including parameters relevant to the endpoint.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function request(url, requestOptions) {\n    if (requestOptions === void 0) { requestOptions = { params: { f: \"json\" } }; }\n    var options = tslib_1.__assign({ httpMethod: \"POST\" }, DEFAULT_ARCGIS_REQUEST_OPTIONS, requestOptions, {\n        params: tslib_1.__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.params, requestOptions.params),\n        headers: tslib_1.__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.headers, requestOptions.headers)\n    });\n    var missingGlobals = [];\n    var recommendedPackages = [];\n    // don't check for a global fetch if a custom implementation was passed through\n    if (!options.fetch && typeof fetch !== \"undefined\") {\n        options.fetch = fetch.bind(Function(\"return this\")());\n    }\n    else {\n        missingGlobals.push(\"`fetch`\");\n        recommendedPackages.push(\"`isomorphic-fetch`\");\n    }\n    if (typeof Promise === \"undefined\") {\n        missingGlobals.push(\"`Promise`\");\n        recommendedPackages.push(\"`es6-promise`\");\n    }\n    if (typeof FormData === \"undefined\") {\n        missingGlobals.push(\"`FormData`\");\n        recommendedPackages.push(\"`isomorphic-form-data`\");\n    }\n    if (!options.fetch ||\n        typeof Promise === \"undefined\" ||\n        typeof FormData === \"undefined\") {\n        throw new Error(\"`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing \" + missingGlobals.join(\", \") + \". We recommend installing the \" + recommendedPackages.join(\", \") + \" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.\");\n    }\n    var httpMethod = options.httpMethod, authentication = options.authentication, rawResponse = options.rawResponse;\n    var params = tslib_1.__assign({ f: \"json\" }, options.params);\n    var fetchOptions = {\n        method: httpMethod,\n        /* ensures behavior mimics XMLHttpRequest.\n        needed to support sending IWA cookies */\n        credentials: \"same-origin\"\n    };\n    return (authentication\n        ? authentication.getToken(url, { fetch: options.fetch }).catch(function (err) {\n            /* if necessary, append original request url and\n             requestOptions to the error thrown by getToken() */\n            err.url = url;\n            err.options = options;\n            throw err;\n        })\n        : Promise.resolve(\"\"))\n        .then(function (token) {\n        if (token.length) {\n            params.token = token;\n        }\n        if (fetchOptions.method === \"GET\") {\n            // encode the parameters into the query string\n            var queryParams = encodeQueryString(params);\n            // dont append a '?' unless parameters are actually present\n            var urlWithQueryString = queryParams === \"\" ? url : url + \"?\" + encodeQueryString(params);\n            if (options.maxUrlLength &&\n                urlWithQueryString.length > options.maxUrlLength) {\n                // the consumer specified a maximum length for URLs\n                // and this would exceed it, so use post instead\n                fetchOptions.method = \"POST\";\n            }\n            else {\n                // just use GET\n                url = urlWithQueryString;\n            }\n        }\n        /* updateResources currently requires FormData even when the input parameters dont warrant it.\n    https://developers.arcgis.com/rest/users-groups-and-items/update-resources.htm\n        see https://github.com/Esri/arcgis-rest-js/pull/500 for more info. */\n        var forceFormData = new RegExp(\"/items/.+/updateResources\").test(url);\n        if (fetchOptions.method === \"POST\") {\n            fetchOptions.body = encodeFormData(params, forceFormData);\n        }\n        // Mixin headers from request options\n        fetchOptions.headers = tslib_1.__assign({}, options.headers);\n        /* istanbul ignore next - karma reports coverage on browser tests only */\n        if (typeof window === \"undefined\" && !fetchOptions.headers.referer) {\n            fetchOptions.headers.referer = NODEJS_DEFAULT_REFERER_HEADER;\n        }\n        /* istanbul ignore else blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\n        if (!requiresFormData(params) && !forceFormData) {\n            fetchOptions.headers[\"Content-Type\"] =\n                \"application/x-www-form-urlencoded\";\n        }\n        return options.fetch(url, fetchOptions);\n    })\n        .then(function (response) {\n        if (!response.ok) {\n            // server responded w/ an actual error (404, 500, etc)\n            var status_1 = response.status, statusText = response.statusText;\n            throw new ArcGISRequestError(statusText, \"HTTP \" + status_1, response, url, options);\n        }\n        if (rawResponse) {\n            return response;\n        }\n        switch (params.f) {\n            case \"json\":\n                return response.json();\n            case \"geojson\":\n                return response.json();\n            case \"html\":\n                return response.text();\n            case \"text\":\n                return response.text();\n            /* istanbul ignore next blob responses are difficult to make cross platform we will just have to trust that isomorphic fetch will do its job */\n            default:\n                return response.blob();\n        }\n    })\n        .then(function (data) {\n        if ((params.f === \"json\" || params.f === \"geojson\") && !rawResponse) {\n            return checkForErrors(data, url, params, options);\n        }\n        else {\n            return data;\n        }\n    });\n}\n//# sourceMappingURL=request.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Enum describing the different errors that might be thrown by a request.\n *\n * ```ts\n * import { request, ErrorTypes } from '@esri/arcgis-rest-request';\n *\n * request(\"...\").catch((e) => {\n *   switch(e.name) {\n *     case ErrorType.ArcGISRequestError:\n *     // handle a general error from the API\n *     break;\n *\n *     case ErrorType.ArcGISAuthError:\n *     // handle an authentication error\n *     break;\n *\n *     default:\n *     // handle some other error (usually a network error)\n *   }\n * });\n * ```\n */\nexport var ErrorTypes;\n(function (ErrorTypes) {\n    ErrorTypes[\"ArcGISRequestError\"] = \"ArcGISRequestError\";\n    ErrorTypes[\"ArcGISAuthError\"] = \"ArcGISAuthError\";\n})(ErrorTypes || (ErrorTypes = {}));\n//# sourceMappingURL=ErrorTypes.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams, requiresFormData } from \"./process-params\";\nimport { encodeQueryString } from \"./encode-query-string\";\n/**\n * Encodes parameters in a [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object in browsers or in a [FormData](https://github.com/form-data/form-data) in Node.js\n *\n * @param params An object to be encoded.\n * @returns The complete [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object.\n */\nexport function encodeFormData(params, forceFormData) {\n    // see https://github.com/Esri/arcgis-rest-js/issues/499 for more info.\n    var useFormData = requiresFormData(params) || forceFormData;\n    var newParams = processParams(params);\n    if (useFormData) {\n        var formData_1 = new FormData();\n        Object.keys(newParams).forEach(function (key) {\n            if (typeof Blob !== \"undefined\" && newParams[key] instanceof Blob) {\n                /* To name the Blob:\n                 1. look to an alternate request parameter called 'fileName'\n                 2. see if 'name' has been tacked onto the Blob manually\n                 3. if all else fails, use the request parameter\n                */\n                var filename = newParams[\"fileName\"] || newParams[key].name || key;\n                formData_1.append(key, newParams[key], filename);\n            }\n            else {\n                formData_1.append(key, newParams[key]);\n            }\n        });\n        return formData_1;\n    }\n    else {\n        return encodeQueryString(params);\n    }\n}\n//# sourceMappingURL=encode-form-data.js.map","import { ArcGISRequestError } from \"./ArcGISRequestError\";\nimport { ArcGISAuthError } from \"./ArcGISAuthError\";\n/**\n * Checks for errors in a JSON response from the ArcGIS REST API. If there are no errors, it will return the `data` passed in. If there is an error, it will throw an `ArcGISRequestError` or `ArcGISAuthError`.\n *\n * @param data The response JSON to check for errors.\n * @param url The url of the original request\n * @param params The parameters of the original request\n * @param options The options of the original request\n * @returns The data that was passed in the `data` parameter\n */\nexport function checkForErrors(response, url, params, options) {\n    // this is an error message from billing.arcgis.com backend\n    if (response.code >= 400) {\n        var message = response.message, code = response.code;\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    // error from ArcGIS Online or an ArcGIS Portal or server instance.\n    if (response.error) {\n        var _a = response.error, message = _a.message, code = _a.code, messageCode = _a.messageCode;\n        var errorCode = messageCode || code || \"UNKNOWN_ERROR_CODE\";\n        if (code === 498 ||\n            code === 499 ||\n            messageCode === \"GWM_0003\" ||\n            (code === 400 && message === \"Unable to generate token.\")) {\n            throw new ArcGISAuthError(message, errorCode, response, url, options);\n        }\n        throw new ArcGISRequestError(message, errorCode, response, url, options);\n    }\n    // error from a status check\n    if (response.status === \"failed\" || response.status === \"failure\") {\n        var message = void 0;\n        var code = \"UNKNOWN_ERROR_CODE\";\n        try {\n            message = JSON.parse(response.statusMessage).message;\n            code = JSON.parse(response.statusMessage).code;\n        }\n        catch (e) {\n            message = response.statusMessage || response.message;\n        }\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    return response;\n}\n//# sourceMappingURL=check-for-errors.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Helper method to ensure that user supplied urls don't include whitespace or a trailing slash.\n */\nexport function cleanUrl(url) {\n    // trim leading and trailing spaces, but not spaces inside the url\n    url = url.trim();\n    // remove the trailing slash to the url if one was included\n    if (url[url.length - 1] === \"/\") {\n        url = url.slice(0, -1);\n    }\n    return url;\n}\n//# sourceMappingURL=clean-url.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport * as tslib_1 from \"tslib\";\nimport { request, cleanUrl, appendCustomParams } from \"@esri/arcgis-rest-request\";\n/**\n * ```js\n * import { getFeature } from '@esri/arcgis-rest-feature-layer';\n * //\n * const url = \"https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/Landscape_Trees/FeatureServer/0\";\n * //\n * getFeature({\n *   url,\n *   id: 42\n * }).then(feature => {\n *  console.log(feature.attributes.FID); // 42\n * });\n * ```\n * Get a feature by id.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with the feature or the [response](https://developer.mozilla.org/en-US/docs/Web/API/Response) itself if `rawResponse: true` was passed in.\n */\nexport function getFeature(requestOptions) {\n    var url = cleanUrl(requestOptions.url) + \"/\" + requestOptions.id;\n    // default to a GET request\n    var options = tslib_1.__assign({ httpMethod: \"GET\" }, requestOptions);\n    return request(url, options).then(function (response) {\n        if (options.rawResponse) {\n            return response;\n        }\n        return response.feature;\n    });\n}\n/**\n * ```js\n * import { queryFeatures } from '@esri/arcgis-rest-feature-layer';\n * //\n * queryFeatures({\n *   url: \"http://sampleserver6.arcgisonline.com/arcgis/rest/services/Census/MapServer/3\",\n *   where: \"STATE_NAME = 'Alaska'\"\n * })\n *   .then(result)\n * ```\n * Query a feature service. See [REST Documentation](https://developers.arcgis.com/rest/services-reference/query-feature-service-layer-.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with the query response.\n */\nexport function queryFeatures(requestOptions) {\n    var queryOptions = appendCustomParams(requestOptions, [\n        \"where\",\n        \"objectIds\",\n        \"relationParam\",\n        \"time\",\n        \"distance\",\n        \"units\",\n        \"outFields\",\n        \"returnGeometry\",\n        \"maxAllowableOffset\",\n        \"geometryPrecision\",\n        \"outSR\",\n        \"gdbVersion\",\n        \"returnDistinctValues\",\n        \"returnIdsOnly\",\n        \"returnCountOnly\",\n        \"returnExtentOnly\",\n        \"orderByFields\",\n        \"groupByFieldsForStatistics\",\n        \"outStatistics\",\n        \"returnZ\",\n        \"returnM\",\n        \"multipatchOption\",\n        \"resultOffset\",\n        \"resultRecordCount\",\n        \"quantizationParameters\",\n        \"returnCentroid\",\n        \"resultType\",\n        \"historicMoment\",\n        \"returnTrueCurves\",\n        \"sqlFormat\",\n        \"returnExceededLimitFeatures\"\n    ], {\n        httpMethod: \"GET\",\n        params: tslib_1.__assign({ \n            // set default query parameters\n            where: \"1=1\", outFields: \"*\" }, requestOptions.params)\n    });\n    return request(cleanUrl(requestOptions.url) + \"/query\", queryOptions);\n}\n//# sourceMappingURL=query.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport * as tslib_1 from \"tslib\";\n/**\n * Helper for methods with lots of first order request options to pass through as request parameters.\n */\nexport function appendCustomParams(customOptions, keys, baseOptions) {\n    var requestOptionsKeys = [\n        \"params\",\n        \"httpMethod\",\n        \"rawResponse\",\n        \"authentication\",\n        \"portal\",\n        \"fetch\",\n        \"maxUrlLength\",\n        \"headers\"\n    ];\n    var options = tslib_1.__assign({ params: {} }, baseOptions, customOptions);\n    // merge all keys in customOptions into options.params\n    options.params = keys.reduce(function (value, key) {\n        if (customOptions[key] || typeof customOptions[key] === \"boolean\") {\n            value[key] = customOptions[key];\n        }\n        return value;\n    }, options.params);\n    // now remove all properties in options that don't exist in IRequestOptions\n    return requestOptionsKeys.reduce(function (value, key) {\n        if (options[key]) {\n            value[key] = options[key];\n        }\n        return value;\n    }, {});\n}\n//# sourceMappingURL=append-custom-params.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport * as tslib_1 from \"tslib\";\nimport { getLayer } from \"./getLayer\";\n/**\n * ```js\n * import { queryFeatures, decodeValues } from '@esri/arcgis-rest-feature-layer';\n * //\n * const url = `https://sampleserver6.arcgisonline.com/arcgis/rest/services/ServiceRequest/FeatureServer/0`\n * queryFeatures({ url })\n *   .then(queryResponse => {\n *     decodeValues({\n *       url,\n *       queryResponse\n *     })\n *       .then(decodedResponse)\n *   })\n * ```\n * Replaces the raw coded domain values in a query response with descriptions (for legibility).\n *\n * @param requestOptions - Options for the request.\n * @returns A Promise that will resolve with the addFeatures response.\n */\nexport function decodeValues(requestOptions) {\n    return new Promise(function (resolve) {\n        if (!requestOptions.fields) {\n            return getLayer({ url: requestOptions.url }).then(function (metadata) {\n                resolve((requestOptions.fields = metadata.fields));\n            });\n        }\n        else {\n            resolve(requestOptions.fields);\n        }\n    }).then(function (fields) {\n        // extract coded value domains\n        var domains = extractCodedValueDomains(fields);\n        if (Object.keys(domains).length < 1) {\n            // no values to decode\n            return requestOptions.queryResponse;\n        }\n        // don't mutate original features\n        var decodedFeatures = requestOptions.queryResponse.features.map(function (feature) {\n            var decodedAttributes = {};\n            for (var key in feature.attributes) {\n                /* istanbul ignore next */\n                if (!feature.attributes.hasOwnProperty(key))\n                    continue;\n                var value = feature.attributes[key];\n                var domain = domains[key];\n                decodedAttributes[key] =\n                    value !== null && domain ? decodeValue(value, domain) : value;\n            }\n            // merge decoded attributes into the feature\n            return tslib_1.__assign({}, feature, { attributes: decodedAttributes });\n        });\n        // merge decoded features into the response\n        return tslib_1.__assign({}, requestOptions.queryResponse, { features: decodedFeatures });\n    });\n}\nfunction extractCodedValueDomains(fields) {\n    return fields.reduce(function (domains, field) {\n        var domain = field.domain;\n        if (domain && domain.type === \"codedValue\") {\n            domains[field.name] = domain;\n        }\n        return domains;\n    }, {});\n}\n// TODO: add type for domain?\nfunction decodeValue(value, domain) {\n    var codedValue = domain.codedValues.find(function (d) {\n        return value === d.code;\n    });\n    return codedValue ? codedValue.name : value;\n}\n//# sourceMappingURL=decodeValues.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { request, cleanUrl } from \"@esri/arcgis-rest-request\";\n/**\n * ```js\n * import { getLayer } from '@esri/arcgis-rest-feature-layer';\n * //\n * getLayer({\n *   url: \"https://sampleserver6.arcgisonline.com/arcgis/rest/services/ServiceRequest/FeatureServer/0\"\n * })\n *   .then(response) // { name: \"311\", id: 0, ... }\n * ```\n * Layer (Feature Service) request. See the [REST Documentation](https://developers.arcgis.com/rest/services-reference/layer-feature-service-.htm) for more information.\n *\n * @param options - Options for the request.\n * @returns A Promise that will resolve with the addFeatures response.\n */\nexport function getLayer(options) {\n    return request(cleanUrl(options.url), options);\n}\n//# sourceMappingURL=getLayer.js.map","export default {\n    fetch: undefined\n};\n//# sourceMappingURL=config.js.map","import { decodeValues, queryFeatures } from '@esri/arcgis-rest-feature-layer';\nimport config from '../config';\nimport { createQueryParams } from './url';\nexport function queryDatasets(datasets) {\n    var names = [];\n    var requests = [];\n    if (datasets) {\n        datasets.forEach(function (dataset, i) {\n            // only query datasets that don't have inline data\n            if (dataset.url) {\n                // TODO: make name required on datasets, or required if > 1 dataset?\n                names.push(dataset.name || \"dataset\" + i);\n                var queryParams = createQueryParams(dataset.query);\n                var options_1 = {\n                    url: dataset.url,\n                    params: queryParams\n                };\n                if (config.fetch && typeof config.fetch === 'function') {\n                    // we are configured to use a custom fetch implementation\n                    // send that along to rest-js\n                    options_1.fetch = config.fetch;\n                }\n                requests.push(queryFeatures(options_1)\n                    .then(function (queryResponse) {\n                    var domains = dataset.domains;\n                    var fields = domains && Object.keys(domains).map(function (name) { return ({ name: name, domain: domains[name] }); });\n                    // for now, we only decode CVDs when an array of fields is passed describing codes and names\n                    if (fields && fields.length > 0) {\n                        var decodeOptions = {\n                            url: options_1.url,\n                            queryResponse: queryResponse,\n                            // TODO: decodeValues() should take `domains?: IDomains` as an alternative to `fields?: IField[]`\n                            fields: fields,\n                            fetch: config.fetch\n                        };\n                        return decodeValues(decodeOptions);\n                    }\n                    else {\n                        return queryResponse;\n                    }\n                }));\n            }\n        });\n    }\n    return Promise.all(requests)\n        .then(function (responses) {\n        // turn the array of responses into a hash keyed off the dataset names\n        var responseHash = responses.reduce(function (hash, response, i) {\n            hash[names[i]] = response;\n            return hash;\n        }, {});\n        return Promise.resolve(responseHash);\n    });\n}\n//# sourceMappingURL=query.js.map","export function defaultQuery() {\n    return {\n        where: '1=1',\n        returnGeometry: false,\n        returnDistinctValues: false,\n        returnIdsOnly: false,\n        returnCountOnly: false,\n        outFields: '*',\n        sqlFormat: 'standard',\n        f: 'json'\n    };\n}\nexport function createQueryParams(query) {\n    if (query === void 0) { query = {}; }\n    // start w/ default query params\n    var queryParams = defaultQuery();\n    // Handle bbox\n    if (query.bbox) {\n        // make sure a geometry was not also passed in\n        if (query.geometry) {\n            throw new Error('Dataset.query can not have both a geometry and a bbox specified');\n        }\n        // Get the bbox (w,s,e,n)\n        var bboxArr = query.bbox.split(',');\n        // Remove it so it's not serialized as-is\n        delete query.bbox;\n        // cook it into a json string\n        query.geometry = JSON.stringify({\n            xmin: Number(bboxArr[0]),\n            ymin: Number(bboxArr[1]),\n            xmax: Number(bboxArr[2]),\n            ymax: Number(bboxArr[3])\n        });\n        // set spatial ref as geographic\n        query.inSR = '4326';\n    }\n    // override defaults w/ params that were passed in\n    Object.keys(query).reduce(function (params, key) {\n        var param = query[key];\n        queryParams[key] = typeof param === 'object' ? JSON.stringify(param) : param;\n        return params;\n    }, queryParams);\n    return queryParams;\n}\n//# sourceMappingURL=url.js.map","import { cedarAmCharts } from '@esri/cedar-amcharts';\nimport { getChartData } from './dataset';\nimport { queryDatasets } from './query/query';\nfunction clone(json) {\n    return JSON.parse(JSON.stringify(json));\n}\n/**\n * An instance of a cedar chart that will be rendered at a given DOM node (container) based on a [definition](../interfaces/idefinition.html).\n * ```js\n *   // initialize the chart\n *   var chart = new Chart(elementId, definition);\n *   // fetch chart data and render the chart\n *   chart.show();\n * ```\n */\nvar Chart = /** @class */ (function () {\n    /**\n     *\n     * @param container The DOM node where the chart will be rendered\n     * @param definition Defines how the data will be rendered in the chart\n     */\n    function Chart(container, definition) {\n        if (!container) {\n            throw new Error('A container is required');\n        }\n        this._container = container;\n        if (definition) {\n            // set the definition\n            this.definition(clone(definition));\n        }\n    }\n    Chart.prototype.definition = function (newDefinition) {\n        if (newDefinition === undefined) {\n            return this._definition;\n        }\n        else {\n            this._definition = newDefinition;\n            return this;\n        }\n    };\n    Chart.prototype.datasets = function (newDatasets) {\n        return this._definitionAccessor('datasets', newDatasets);\n    };\n    Chart.prototype.series = function (newSeries) {\n        return this._definitionAccessor('series', newSeries);\n    };\n    Chart.prototype.type = function (newType) {\n        return this._definitionAccessor('type', newType);\n    };\n    Chart.prototype.specification = function (newSpecification) {\n        return this._definitionAccessor('specification', newSpecification);\n    };\n    Chart.prototype.overrides = function (newOverrides) {\n        return this._definitionAccessor('overrides', newOverrides);\n    };\n    Chart.prototype.legend = function (newLegend) {\n        return this._definitionAccessor('legend', newLegend);\n    };\n    /**\n     * Get the chart's styles\n     */\n    Chart.prototype.style = function (newStyle) {\n        return this._definitionAccessor('style', newStyle);\n    };\n    /**\n     * Get the internal copy of the data used to render the chart\n     */\n    Chart.prototype.data = function () {\n        return this._data;\n    };\n    /**\n     * Get a dataset from the definition by name\n     * @param datasetName The name of the dataset to get\n     */\n    Chart.prototype.dataset = function (datasetName) {\n        var datasets = this.datasets();\n        var match;\n        if (datasets) {\n            datasets.some(function (dataset) {\n                if (dataset.name === datasetName) {\n                    match = dataset;\n                    return true;\n                }\n            });\n        }\n        return match;\n    };\n    /**\n     * Query data for all non-inline datasets\n     */\n    Chart.prototype.query = function () {\n        return queryDatasets(this.datasets());\n    };\n    // update chart from inline data and query responses\n    Chart.prototype.updateData = function (datasetsData) {\n        var datasets = this.datasets();\n        var options = {\n            datasetsData: datasetsData,\n            series: this.series()\n        };\n        this._data = getChartData(datasets, options);\n        return this;\n    };\n    /**\n     * Re-draw the chart based on the current data and definition\n     */\n    Chart.prototype.render = function () {\n        cedarAmCharts(this._container, this.definition(), this.data());\n        return this;\n    };\n    /**\n     * Execute the query(), updateData(), and render() functions\n     */\n    Chart.prototype.show = function () {\n        var _this = this;\n        return this.query()\n            .then(function (response) {\n            return _this.updateData(response).render();\n        });\n    };\n    // implementation for all setters/getters for definition properties\n    Chart.prototype._definitionAccessor = function (propertyName, newPropertyValue) {\n        var definition = this._definition;\n        if (newPropertyValue === undefined) {\n            return definition ? definition[propertyName] : undefined;\n        }\n        else {\n            if (definition) {\n                definition[propertyName] = newPropertyValue;\n                return this;\n            }\n            else {\n                var newDefinition = {};\n                newDefinition[propertyName] = newPropertyValue;\n                return this.definition(newDefinition);\n            }\n        }\n    };\n    return Chart;\n}());\nexport { Chart };\n//# sourceMappingURL=Chart.js.map","import render from './render/render';\nexport function cedarAmCharts(elementId, definition, data) {\n    if ((!elementId || !definition || !data) && (definition.type && definition.type !== 'custom')) {\n        var err = new Error('Element Id, definition, and data are all required.');\n        throw err;\n    }\n    if (definition.type && definition.type === 'custom') {\n        return render.renderChart(elementId, definition);\n    }\n    return render.renderChart(elementId, definition, data);\n}\nexport default cedarAmCharts;\n//# sourceMappingURL=index.js.map"],"names":["isMergeableObject","value","stringValue","Object","prototype","toString","call","$$typeof","REACT_ELEMENT_TYPE","Symbol","for","cloneIfNecessary","optionsArgument","val","clone","deepmerge","Array","isArray","defaultArrayMerge","target","source","destination","slice","forEach","e","i","indexOf","push","sourceIsArray","arrayMerge","keys","key","all","array","length","Error","reduce","prev","next","deepmerge_1","specs","bar","type","rotate","theme","chartCursor","categoryBalloonEnabled","graphs","newStack","legend","valueAlign","spacing","valueAxes","stackType","export","enabled","bar-horizontal","leaveCursor","valueLineEnabled","gridAlpha","line","valueLineBalloonEnabled","bullet","bulletAlpha","bulletBorderAlpha","bulletBorderThickness","dashLengthField","fillAlphas","useLineColorForBulletBorder","position","useGraphSettings","area","horizontalGap","markerSize","pie","innerRadius","startDuration","groupPercent","balloon","fixedPosition","radar","gridType","minimum","polarScatter","maximum","step","graphFillAlpha","marginRight","autoMargins","scatter","axisAlpha","chartScrollbar","scrollbarHeight","offset","backgroundAlpha","backgroundColor","selectedBackgroundColor","selectedBackgroundAlpha","dragIconWidth","dragIconHeight","cursorAlpha","valueLineAlpha","lineAlpha","valueField","xField","yField","timeline","categoryAxis","parseDates","fillInSpec","spec","definition","graphSpec","pop","isJoined","datasets","categoryField","series","category","field","tabIndex","hasOwnProperty","visible","enable","categoryAxisTitle_1","label","valueAxisTitle_1","axis","title","style","padding","marginTop","top","marginBottom","bottom","marginLeft","left","right","pullOutRadius","expand","colors","dataset","d","datasetName","name","s","graph","balloonText","stack","titleField","size","fetchSpec","console","warn","json","JSON","parse","stringify","render","renderChart","elementId","data","AmCharts","makeChart","specification","copyData","dataProvider","overrides","merge","categoryLabel","valueLabel","chart","getFeatures","features","getAttributes","row","attributes","getDatasetData","datasetsData","getChartData","options","hashTable","index","joinKey","join","datasetData","valueFields","fields","feature","attrs","joinValue","undefined","map","extendStatics","b","setPrototypeOf","__proto__","p","__assign","assign","t","n","arguments","apply","this","requiresFormData","params","some","toParam","constructor","processParams","newParams","param","valueOf","encodeQueryString","encodeURIComponent","ArcGISRequestError","message","code","response","url","originalMessage","create","ArcGISAuthError","_super","_this","__","tslib_1.__extends","retry","getSession","retryLimit","tries","retryRequest","resolve","reject","then","session","newOptions","tslib_1.__assign","authentication","request","catch","Promise","ErrorTypes","NODEJS_DEFAULT_REFERER_HEADER","DEFAULT_ARCGIS_REQUEST_OPTIONS","httpMethod","f","requestOptions","headers","missingGlobals","recommendedPackages","fetch","bind","Function","FormData","rawResponse","fetchOptions","method","credentials","getToken","err","token","urlWithQueryString","maxUrlLength","forceFormData","RegExp","test","body","useFormData","formData_1","Blob","filename","append","encodeFormData","window","referer","ok","status_1","status","statusText","text","blob","error","_a","messageCode","errorCode","statusMessage","checkForErrors","cleanUrl","trim","queryFeatures","customOptions","baseOptions","queryOptions","where","outFields","decodeValues","metadata","domains","domain","queryResponse","decodedFeatures","decodedAttributes","decodeValue","codedValue","codedValues","find","queryDatasets","names","requests","queryParams","query","returnGeometry","returnDistinctValues","returnIdsOnly","returnCountOnly","sqlFormat","bbox","geometry","bboxArr","split","xmin","Number","ymin","xmax","ymax","inSR","createQueryParams","options_1","config","responses","responseHash","hash","Chart","container","_container","newDefinition","_definition","newDatasets","_definitionAccessor","newSeries","newType","newSpecification","newOverrides","newLegend","newStyle","_data","match","updateData","cedarAmCharts","show","propertyName","newPropertyValue"],"mappings":"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"}