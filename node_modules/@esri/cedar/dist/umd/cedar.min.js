/**
* @esri/cedar - v1.0.1 - Tue May 07 2019 11:11:39 GMT-0700 (PDT)
* Copyright (c) 2019 Environmental Systems Research Institute, Inc.
* Apache-2.0
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.cedar={})}(this,function(e){"use strict";var l=function(e){return!(!(n=e)||"object"!=typeof n||(t=e,"[object RegExp]"===(r=Object.prototype.toString.call(t))||"[object Date]"===r||t.$$typeof===a));var t,r,n};var a="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function u(e,t){var r;return t&&!0===t.clone&&l(e)?d((r=e,Array.isArray(r)?[]:{}),e,t):e}function c(r,e,n){var a=r.slice();return e.forEach(function(e,t){void 0===a[t]?a[t]=u(e,n):l(e)?a[t]=d(r[t],e,n):-1===r.indexOf(e)&&a.push(u(e,n))}),a}function d(e,t,r){var n,a,o,i,s=Array.isArray(t);return s===Array.isArray(e)?s?((r||{arrayMerge:c}).arrayMerge||c)(e,t,r):(a=t,o=r,i={},l(n=e)&&Object.keys(n).forEach(function(e){i[e]=u(n[e],o)}),Object.keys(a).forEach(function(e){l(a[e])&&n[e]?i[e]=d(n[e],a[e],o):i[e]=u(a[e],o)}),i):u(t,r)}d.all=function(e,r){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,t){return d(e,t,r)})};var p=d,r={bar:{type:"serial",rotate:!1,theme:"calcite",chartCursor:{categoryBalloonEnabled:!1},graphs:[{type:"column",newStack:!0}],legend:{valueAlign:"left",spacing:25},valueAxes:[{stackType:"regular"}],export:{enabled:!0}},"bar-horizontal":{type:"serial",theme:"calcite",rotate:!0,chartCursor:{leaveCursor:!0,valueLineEnabled:!0,categoryBalloonEnabled:!1},graphs:[{type:"column"}],legend:{},valueAxes:[{gridAlpha:.2,stackType:"regular"}],export:{enabled:!0}},line:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:0,useLineColorForBulletBorder:!0}],legend:{position:"bottom",useGraphSettings:!0},export:{enabled:!0}},area:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:.5,useLineColorForBulletBorder:!0}],legend:{horizontalGap:10,position:"bottom",useGraphSettings:!0,markerSize:10},valueAxes:[{stackType:"regular"}],export:{enabled:!0}},pie:{type:"pie",theme:"calcite",innerRadius:"0%",startDuration:0,graphs:[{}],groupPercent:5,balloon:{fixedPosition:!0},legend:{enabled:!1},export:{enabled:!0}},radar:{type:"radar",valueAxes:[{gridType:"circles",minimum:0}],polarScatter:{minimum:0,maximum:400,step:1},startDuration:0,graphs:[{graphFillAlpha:0}],groupPercent:5,balloon:{fixedPosition:!0},legend:{position:"right",marginRight:100,autoMargins:!1}},scatter:{type:"xy",theme:"calcite",valueAxes:[{axisAlpha:.8,gridAlpha:.2,position:"bottom"},{axisAlpha:.8,gridAlpha:.2,position:"left"}],chartScrollbar:{scrollbarHeight:5,offset:-1,backgroundAlpha:.1,backgroundColor:"#888888",selectedBackgroundColor:"#67b7dc",selectedBackgroundAlpha:1,dragIconWidth:15,dragIconHeight:15},chartCursor:{categoryBalloonEnabled:!0,cursorAlpha:.3,valueLineAlpha:.3,valueLineBalloonEnabled:!0},graphs:[{fillAlphas:0,lineAlpha:0,bullet:"circle",bulletBorderAlpha:.2,bulletAlpha:.8,valueField:null,xField:null,yField:null}],export:{enabled:!0}},timeline:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:0,useLineColorForBulletBorder:!0}],legend:{position:"bottom",useGraphSettings:!0},categoryAxis:{parseDates:!0},export:{enabled:!0}}};function f(o,i){var s=o.graphs.pop(),l=1<i.datasets.length;if(o.categoryField=l?"categoryField":i.series[0].category.field,o.tabIndex=0,o.legend||(o.legend={}),i.legend&&i.legend.hasOwnProperty("enable")&&(i.legend.visible=i.legend.enable),1===i.series.length&&"pie"!==i.type&&"radar"!==i.type){o.legend.enabled=!1;var t=i.series[0].category.label,r=i.series[0].value.label;"xy"===o.type&&Array.isArray(o.valueAxes)?o.valueAxes.forEach(function(e){"bottom"===e.position?e.title=t:"left"===e.position&&(e.title=r)}):(o.valueAxes||(o.valueAxes=[{}]),o.valueAxes[0].title=i.series[0].value.label,o.valueAxes[0].position="left",o.categoryAxis||(o.categoryAxis={}),o.categoryAxis.title=t)}if(i.legend){var e=i.legend;e.hasOwnProperty("visible")&&(o.legend.enabled=e.visible,o.legend.tabIndex=0),e.position&&-1<["top","bottom","left","right"].indexOf(e.position)&&(o.legend.position=e.position)}if(i.style){var n=i.style;if(n.padding){var a=n.padding;o.autoMargins=!1,a.hasOwnProperty("top")&&(o.marginTop=a.top),a.hasOwnProperty("bottom")&&(o.marginBottom=a.bottom),a.hasOwnProperty("left")&&(o.marginLeft=a.left),a.hasOwnProperty("right")&&(o.marginRight=a.right)}if(n.pie){var u=n.pie;u.hasOwnProperty("innerRadius")&&(o.innerRadius=u.innerRadius),u.hasOwnProperty("expand")&&(o.pullOutRadius=u.expand)}n.colors&&Array.isArray(n.colors)&&(o.colors=n.colors)}return i.datasets.forEach(function(n,e){var a=n.name;i.series.forEach(function(e,t){if(n.name===e.source){var r=y(s);r.title=e.value.label,r.valueField=l?a+"_"+e.value.field:e.value.field,r.balloonText="<div>"+e.category.label+": [["+o.categoryField+"]]</div><div>"+r.title+": [["+r.valueField+"]]</div>",e.stack&&r.newStack&&(r.newStack=!1),"pie"===i.type&&(o.titleField=o.categoryField,o.valueField=r.valueField),"xy"===o.type&&e.category&&e.value&&(r.xField=e.category.field,r.yField=e.value.field,r.balloonText="<div>"+e.category.label+": [["+e.category.field+"]]</div><div>"+e.value.label+": [["+e.value.field+"]]</div>","xy"===o.type&&e.size?(r.valueField=e.size.field,r.balloonText=r.balloonText+"<div>"+e.size.label+": [["+r.valueField+"]]</div>"):delete r.valueField),o.graphs.push(r)}})}),o}function h(e){var t=e;return"time"===t?(console.warn("'time' is no longer a supported type. Please use 'timeline' instead"),t="timeline"):"bubble"===t?(console.warn("'bubble' is no longer a supported type. Please use 'scatter' instead"),t="scatter"):"grouped"===t&&(console.warn("'grouped' is no longer a supported type. Please use 'bar' instead"),t="bar"),y(r[t])}function y(e){return JSON.parse(JSON.stringify(e))}var n={renderChart:function(e,t,r){if("custom"===t.type)return AmCharts.makeChart(e,t.specification);var n=t.specification&&"string"!=typeof t.specification?y(t.specification):h(t.type),a=y(r);n.dataProvider=a,t.datasets&&(n=f(n,t)),t.overrides&&(n=p(n,t.overrides,{clone:!0}));var o,i,s,l=AmCharts.makeChart(e,n);return"pie"===t.type&&(l.balloonText=(i=(o=t).series[0].category.label?o.series[0].category.label+": ":"",s=o.series[0].value.label?o.series[0].value.label+": ":"","<div>"+i+"[[title]]</div><div>"+s+"[[percents]]% ([[value]])</div>")),l},fillInSpec:f,fetchSpec:h};function m(e){return e.features?e.features:e}function g(e){return e.attributes?e.attributes:e}function v(e,t,r){var n=e.name||r;return e.data||t[n]}function o(e,t){if(e){if(e.length<1)return[];var l,u,r,n=t&&t.datasetsData;if(1<e.length){var a=t&&t.series;return l=a,u=n,r=e.reduce(function(r,e,t){var n,o=e.join,a=v(e,u),i=e.name,s=(n=i,l.reduce(function(e,t){return t.source===n&&t.value&&e.push(t.value.field),e},[]));return m(a).forEach(function(e){var a=g(e),t=a[o];void 0===r[t]&&(r[t]={categoryField:t}),s.reduce(function(e,t){var r,n;return e[(r=i,n=t,r+"_"+n)]=a[t],e},r[t])}),r},{}),Object.keys(r).map(function(e){return r[e]})}var o,i=v(e[0],n,"dataset0");return 0<(o=m(i)).length&&o[0].attributes?o.map(g):o}}var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var b=function(){return(b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */function A(r){return Object.keys(r).some(function(e){var t=r[e];if(!t)return!1;switch(t&&t.toParam&&(t=t.toParam()),t.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function O(n){var a={};return Object.keys(n).forEach(function(e){var t=n[e];if(t&&t.toParam&&(t=t.toParam()),t||0===t||"boolean"==typeof t||"string"==typeof t){var r;switch(t.constructor.name){case"Array":r=t[0]&&t[0].constructor&&"Object"===t[0].constructor.name?JSON.stringify(t):t.join(",");break;case"Object":r=JSON.stringify(t);break;case"Date":r=t.valueOf();break;case"Function":r=null;break;case"Boolean":r=t+"";break;default:r=t}(r||0===r||"string"==typeof r)&&(a[e]=r)}}),a}
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */function x(e){var n=O(e);return Object.keys(n).map(function(e){return r=n[t=e],encodeURIComponent(t)+"="+encodeURIComponent(r);var t,r}).join("&")}
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
var w=function(e,t,r,n,a){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=a};w.prototype=Object.create(Error.prototype);var E=function(i){function e(e,t,r,n,a){void 0===e&&(e="AUTHENTICATION_ERROR"),void 0===t&&(t="AUTHENTICATION_ERROR_CODE");var o=i.call(this,e,t,r,n,a)||this;return o.name="ArcGISAuthError",o.message="AUTHENTICATION_ERROR_CODE"===t?e:t+": "+e,o}return function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(e,i),e.prototype.retry=function(e,n){var a=this;void 0===n&&(n=3);var o=0,i=function(t,r){e(a.url,a.options).then(function(e){var t=b({},a.options,{authentication:e});return o+=1,F(a.url,t)}).then(function(e){t(e)}).catch(function(e){"ArcGISAuthError"===e.name&&o<n?i(t,r):"ArcGISAuthError"===e.name&&n<=o?r(a):r(e)})};return new Promise(function(e,t){i(e,t)})},e}(w.prototype.constructor=w);
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
var t,i,R="@esri/arcgis-rest-js",S={httpMethod:"POST",params:{f:"json"}};function F(n,e){void 0===e&&(e={params:{f:"json"}});var a=b({httpMethod:"POST"},S,e,{params:b({},S.params,e.params),headers:b({},S.headers,e.headers)}),t=[],r=[];if(a.fetch||"undefined"==typeof fetch?(t.push("`fetch`"),r.push("`isomorphic-fetch`")):a.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(t.push("`Promise`"),r.push("`es6-promise`")),"undefined"==typeof FormData&&(t.push("`FormData`"),r.push("`isomorphic-form-data`")),!a.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires global variables for `fetch`, `Promise` and `FormData` to be present in the global scope. You are missing "+t.join(", ")+". We recommend installing the "+r.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var o=a.httpMethod,i=a.authentication,s=a.rawResponse,l=b({f:"json"},a.params),u={method:o,credentials:"same-origin"};return(i?i.getToken(n,{fetch:a.fetch}).catch(function(e){throw e.url=n,e.options=a,e}):Promise.resolve("")).then(function(e){if(e.length&&(l.token=e),"GET"===u.method){var t=""===x(l)?n:n+"?"+x(l);a.maxUrlLength&&t.length>a.maxUrlLength?u.method="POST":n=t}var r=new RegExp("/items/.+/updateResources").test(n);return"POST"===u.method&&(u.body=function(e,t){var r=A(e)||t,n=O(e);if(r){var a=new FormData;return Object.keys(n).forEach(function(e){if("undefined"!=typeof Blob&&n[e]instanceof Blob){var t=n.fileName||n[e].name||e;a.append(e,n[e],t)}else a.append(e,n[e])}),a}return x(e)}(l,r)),u.headers=b({},a.headers),"undefined"!=typeof window||u.headers.referer||(u.headers.referer=R),A(l)||r||(u.headers["Content-Type"]="application/x-www-form-urlencoded"),a.fetch(n,u)}).then(function(e){if(!e.ok){var t=e.status,r=e.statusText;throw new w(r,"HTTP "+t,e,n,a)}if(s)return e;switch(l.f){case"json":case"geojson":return e.json();case"html":case"text":return e.text();default:return e.blob()}}).then(function(e){return"json"!==l.f&&"geojson"!==l.f||s?e:function(t,e,r,n){if(400<=t.code){var a=t.message,o=t.code;throw new w(a,o,t,e,n)}if(t.error){var i=t.error,s=(a=i.message,o=i.code,i.messageCode),l=s||o||"UNKNOWN_ERROR_CODE";if(498===o||499===o||"GWM_0003"===s||400===o&&"Unable to generate token."===a)throw new E(a,l,t,e,n);throw new w(a,l,t,e,n)}if("failed"===t.status||"failure"===t.status){a=void 0,o="UNKNOWN_ERROR_CODE";try{a=JSON.parse(t.statusMessage).message,o=JSON.parse(t.statusMessage).code}catch(e){a=t.statusMessage||t.message}throw new w(a,o,t,e,n)}return t}(e,n,0,a)})}
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
function P(e){return"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018-2019 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
function _(e){var r,t,n,a,o=(t=["where","objectIds","relationParam","time","distance","units","outFields","returnGeometry","maxAllowableOffset","geometryPrecision","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures"],n={httpMethod:"GET",params:b({where:"1=1",outFields:"*"},(r=e).params)},(a=b({params:{}},n,r)).params=t.reduce(function(e,t){return(r[t]||"boolean"==typeof r[t])&&(e[t]=r[t]),e},a.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(function(e,t){return a[t]&&(e[t]=a[t]),e},{}));return F(P(e.url)+"/query",o)}
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */
function j(r){return new Promise(function(t){if(!r.fields)return(e={url:r.url},F(P(e.url),e)).then(function(e){t(r.fields=e.fields)});var e;t(r.fields)}).then(function(e){var o=e.reduce(function(e,t){var r=t.domain;return r&&"codedValue"===r.type&&(e[t.name]=r),e},{});if(Object.keys(o).length<1)return r.queryResponse;var t=r.queryResponse.features.map(function(e){var t={};for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)){var n=e.attributes[r],a=o[r];t[r]=null!==n&&a?C(n,a):n}return b({},e,{attributes:t})});return b({},r.queryResponse,{features:t})})}function C(t,e){var r=e.codedValues.find(function(e){return t===e.code});return r?r.name:t}
/* Copyright (c) 2018-2019 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */(i=t||(t={})).ArcGISRequestError="ArcGISRequestError",i.ArcGISAuthError="ArcGISAuthError";var N={fetch:void 0};function k(e){var o=[],r=[];return e&&e.forEach(function(n,e){if(n.url){o.push(n.name||"dataset"+e);var t=function(n){void 0===n&&(n={});var a={where:"1=1",returnGeometry:!1,returnDistinctValues:!1,returnIdsOnly:!1,returnCountOnly:!1,outFields:"*",sqlFormat:"standard",f:"json"};if(n.bbox){if(n.geometry)throw new Error("Dataset.query can not have both a geometry and a bbox specified");var e=n.bbox.split(",");delete n.bbox,n.geometry=JSON.stringify({xmin:Number(e[0]),ymin:Number(e[1]),xmax:Number(e[2]),ymax:Number(e[3])}),n.inSR="4326"}return Object.keys(n).reduce(function(e,t){var r=n[t];return a[t]="object"==typeof r?JSON.stringify(r):r,e},a),a}(n.query),a={url:n.url,params:t};r.push(_(a).then(function(e){var t=n.domains,r=t&&Object.keys(t).map(function(e){return{name:e,domain:t[e]}});return r&&0<r.length?j({url:a.url,queryResponse:e,fields:r,fetch:N.fetch}):e}))}}),Promise.all(r).then(function(e){var t=e.reduce(function(e,t,r){return e[o[r]]=t,e},{});return Promise.resolve(t)})}var T=function(){function e(e,t){if(!e)throw new Error("A container is required");var r;this._container=e,t&&this.definition((r=t,JSON.parse(JSON.stringify(r))))}return e.prototype.definition=function(e){return void 0===e?this._definition:(this._definition=e,this)},e.prototype.datasets=function(e){return this._definitionAccessor("datasets",e)},e.prototype.series=function(e){return this._definitionAccessor("series",e)},e.prototype.type=function(e){return this._definitionAccessor("type",e)},e.prototype.specification=function(e){return this._definitionAccessor("specification",e)},e.prototype.overrides=function(e){return this._definitionAccessor("overrides",e)},e.prototype.legend=function(e){return this._definitionAccessor("legend",e)},e.prototype.style=function(e){return this._definitionAccessor("style",e)},e.prototype.data=function(){return this._data},e.prototype.dataset=function(t){var r,e=this.datasets();return e&&e.some(function(e){if(e.name===t)return r=e,!0}),r},e.prototype.query=function(){return k(this.datasets())},e.prototype.updateData=function(e){var t=this.datasets(),r={datasetsData:e,series:this.series()};return this._data=o(t,r),this},e.prototype.render=function(){return function(e,t,r){if((!e||!t||!r)&&t.type&&"custom"!==t.type)throw new Error("Element Id, definition, and data are all required.");t.type&&"custom"===t.type?n.renderChart(e,t):n.renderChart(e,t,r)}(this._container,this.definition(),this.data()),this},e.prototype.show=function(){var t=this;return this.query().then(function(e){return t.updateData(e).render()})},e.prototype._definitionAccessor=function(e,t){var r=this._definition;if(void 0===t)return r?r[e]:void 0;if(r)return r[e]=t,this;var n={};return n[e]=t,this.definition(n)},e}();
/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.
     * Apache-2.0 */e.Chart=T,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=cedar.min.js.map
